<!--
本文件由智谱 AI 自动翻译生成
原文件: SKILL.md
翻译时间: 2025-12-12 16:11:56
翻译模型: glm-4-flash
原文大小: 11,620 字符
-->

---
name: 发票整理器
description: 通过读取杂乱的文件、提取关键信息、统一重命名以及将它们分类到逻辑文件夹中，自动整理发票和收据以备税务准备。将数小时的手动记账工作转化为几分钟的自动化整理。
---

# 发票整理器

这项技能将混乱的发票、收据和财务文件整理成干净、备好税的文件系统，无需手动操作。

## 何时使用此技能

- 准备税务季节并需要整理的记录
- 管理多个供应商的业务费用
- 整理杂乱文件夹或电子邮件下载的收据
- 设置自动发票归档以进行持续记账
- 按年份或类别存档财务记录
- 核对报销费用
- 准备会计师的文件

## 此技能的功能

1. **读取发票内容**：从PDF、图像和文档中提取信息：
   - 供应商/公司名称
   - 发票号码
   - 日期
   - 金额
   - 产品或服务描述
   - 付款方式

2. **统一重命名文件**：创建标准化的文件名：
   - 格式：`YYYY-MM-DD 供应商 - 发票 - 产品Or服务.pdf`
   - 示例：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`

3. **按类别组织**：分类到逻辑文件夹：
   - 按供应商
   - 按费用类别（软件、办公用品、差旅等）
   - 按时间段（年份、季度、月份）
   - 按税务类别（可抵扣、个人等）

4. **处理多种格式**：支持：
   - PDF发票
   - 扫描收据（JPG、PNG）
   - 电子邮件附件
   - 屏幕截图
   - 银行对账单

5. **保留原始文件**：在整理副本的同时保留原始文件

## 如何使用

### 基本用法

导航到您的杂乱发票文件夹：
```
cd ~/Desktop/receipts-to-sort
```

然后询问Claude Code：
```
整理这些发票以备税务
```

或者更具体地：
```
读取此文件夹中的所有发票，将它们重命名为 "YYYY-MM-DD 供应商 - 发票 - 产品.pdf" 格式，并按供应商组织
```

### 高级组织

```
整理以下发票：
1. 从每个文件中提取日期、供应商和描述
2. 重命名为标准格式
3. 按费用类别（软件、办公用品、差旅等）组织到文件夹中
4. 为我的会计师创建包含所有发票详细信息的CSV电子表格
```

## 指示

当用户请求发票整理时：

1. **扫描文件夹**

   识别所有发票文件：
   ```bash
   # 查找所有与发票相关的文件
   find . -type f \( -name "*.pdf" -o -name "*.jpg" -o -name "*.png" \) -print
   ```
   
   报告发现：
   - 文件总数
   - 文件类型
   - 日期范围（如果从名称中可识别）
   - 当前组织（或无组织）

2. **从每个文件中提取信息**

   对于每个发票，提取：
   
   **从PDF发票中**：
   - 使用文本提取来读取发票内容
   - 寻找常见模式：
     - "发票日期："、"日期："、"发行："
     - "发票 #"："、"发票号码："
     - 公司名称（通常在顶部）
     - "应付金额："、"总计："、"金额："
     - "描述："、"服务："、"产品："
   
   **从图像收据中**：
   - 从图像中读取可见文本
   - 识别供应商名称（通常在顶部）
   - 寻找日期（常见格式）
   - 找到总金额
   
   **对于不清晰的文件**：
   - 使用文件名线索
   - 检查文件创建/修改日期
   - 如果关键信息缺失，则标记为手动审查

3. **确定组织策略**

   如果未指定，询问用户偏好：
   
   ```markdown
   我发现了 [X] 份从 [日期范围] 的发票。
   
   您希望如何组织它们？
   
   1. **按供应商**（Adobe/、Amazon/、Stripe/等）
   2. **按类别**（软件/、办公用品/、差旅/等）
   3. **按日期**（2024/Q1/、2024/Q2/等）
   4. **按税务类别**（可抵扣/、个人/等）
   5. **自定义**（描述您的结构）
   
   或者我可以使用默认结构：年份/类别/供应商
   ```

4. **创建标准化文件名**

   对于每个发票，创建一个遵循以下模式的文件名：
   
   ```
   YYYY-MM-DD 供应商 - 发票 - 描述.ext
   ```
   
   示例：
   - `2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   - `2024-01-10 Amazon - 收据 - 办公用品.pdf`
   - `2023-12-01 Stripe - 发票 - 每月支付处理.pdf`
   
   **文件名最佳实践**：
   - 移除特殊字符（除连字符外）
   - 正确大写供应商名称
   - 保持描述简短但有意义
   - 使用一致的日期格式（YYYY-MM-DD）以供排序
   - 保留原始文件扩展名

5. **执行组织**

   在移动文件之前，显示计划：
   
   ```markdown
   # 组织计划
   
   ## 建议的结构
   ```
   Invoices/
   ├── 2023/
   │   ├── 软件/
   │   │   ├── Adobe/
   │   │   └── Microsoft/
   │   ├── 服务/
   │   └── 办公/
   └── 2024/
       ├── 软件/
       ├── 服务/
       └── 办公/
   ```
   
   ## 示例更改
   
   之前：`invoice_adobe_march.pdf`
   之后：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   位置：`Invoices/2024/Software/Adobe/`
   
   之前：`IMG_2847.jpg`
   之后：`2024-02-10 Staples - 收据 - 办公用品.jpg`
   位置：`Invoices/2024/Office/Staples/`
   
   处理 [X] 个文件？ (是/否)
   ```
   
   在获得批准后：
   ```bash
   # 创建文件夹结构
   mkdir -p "Invoices/2024/Software/Adobe"
   
   # 复制（不移动）以保留原始文件
   cp "original.pdf" "Invoices/2024/Software/Adobe/2024-03-15 Adobe - 发票 - Creative Cloud.pdf"
   
   # 或者移动，如果用户更喜欢
   mv "original.pdf" "new/path/standardized-name.pdf"
   ```

6. **生成摘要报告**

   创建包含所有发票详细信息的CSV文件：
   
   ```csv
   日期,供应商,发票号码,描述,金额,类别,文件路径
   2024-03-15,Adobe,INV-12345,Creative Cloud,52.99,软件,Invoices/2024/Software/Adobe/2024-03-15 Adobe - 发票 - Creative Cloud.pdf
   2024-03-10,Amazon,123-4567890-1234567,办公用品,127.45,办公用品,Invoices/2024/Office/Amazon/2024-03-10 Amazon - 收据 - 办公用品.pdf
   ...
   ```
   
   此CSV文件很有用：
   - 导入到会计软件
   - 与会计师共享
   - 费用跟踪和报告
   - 税务准备

7. **提供完成摘要**

   ```markdown
   # 组织完成！ 📊
   
   ## 摘要
   - **处理**：[X] 份发票
   - **日期范围**：[最早] 到 [最新]
   - **总金额**：$[总和]（如果提取了金额）
   - **供应商**：[Y] 个唯一供应商
   
   ## 新结构
   ```
   Invoices/
   ├── 2024/ (45 files)
   │   ├── 软件/ (23 files)
   │   ├── 服务/ (12 files)
   │   └── 办公/ (10 files)
   └── 2023/ (12 files)
   ```
   
   ## 创建的文件
   - `/Invoices/` - 组织好的发票
   - `/Invoices/invoice-summary.csv` - 会计电子表格
   - `/Invoices/originals/` - 原始文件（如果已复制）
   
   ## 需要审查的文件
   [列出任何信息无法完全提取的文件]
   
   ## 下一步
   1. 审查 `invoice-summary.csv` 文件
   2. 检查 "需要审查" 文件夹中的文件
   3. 将CSV导入到您的会计软件中
   4. 设置未来发票的自动组织
   
   准备好税务季节！ 🎉
   ```

## 示例

### 示例 1：税务准备（来自Martin Merschroth）

**用户**："我有一个杂乱的发票文件夹，用于税务。整理它们并正确重命名。"

**过程**：
1. 扫描文件夹：找到147个PDF和图像
2. 读取每个发票以提取：
   - 日期
   - 供应商名称
   - 发票号码
   - 产品/服务描述
3. 重命名所有文件：`YYYY-MM-DD 供应商 - 发票 - 产品.pdf`
4. 组织到：`2024/Software/`、`2024/Travel/`等
5. 为会计师创建`invoice-summary.csv`
6. 结果：在几分钟内准备好税务整理的发票

### 示例 2：每月费用核对

**用户**："整理我上个月的业务收据，按类别组织。"

**输出**：
```markdown
# 2024年3月收据整理

## 按类别
- 软件 & 工具：$847.32（12份发票）
- 办公用品：$234.18（8张收据）
- 差旅 & 餐饮：$1,456.90（15张收据）
- 专业服务：$2,500.00（3份发票）

总计：$5,038.40

所有收据已重命名并归档到：
`Business-Receipts/2024/03-March/[类别]/`

CSV导出：`march-2024-expenses.csv`
```

### 示例 3：多年存档

**用户**："我有3年的随机发票。按年份、然后按供应商组织它们。"

**输出**：创建结构：
```
Invoices/
├── 2022/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
├── 2023/
│   ├── Adobe/
│   ├── Amazon/
│   └── ...
└── 2024/
    ├── Adobe/
    ├── Amazon/
    └── ...
```

每个文件都正确重命名，带有日期和描述。

### 示例 4：电子邮件下载清理

**用户**："我从Gmail下载发票。它们都命名为 'invoice.pdf'、'invoice(1).pdf' 等。修复这个混乱。"

**输出**：
```markdown
找到89个所有命名为 "invoice*.pdf" 的文件

读取每个文件以提取真实信息...

重命名示例：
- invoice.pdf → 2024-03-15 Shopify - 发票 - 每月订阅.pdf
- invoice(1).pdf → 2024-03-14 Google - 发票 - Workspace.pdf
- invoice(2).pdf → 2024-03-10 Netlify - 发票 - Pro Plan.pdf

所有文件已重命名并按供应商组织。
```

## 常见组织模式

### 按供应商（简单）
```
Invoices/
├── Adobe/
├── Amazon/
├── Google/
└── Microsoft/
```

### 按年份和类别（税务友好）
```
Invoices/
├── 2023/
│   ├── 软件/
│   ├── 硬件/
│   ├── 服务/
│   └── 差旅/
└── 2024/
    └── ...
```

### 按季度（详细跟踪）
```
Invoices/
├── 2024/
│   ├── Q1/
│   │   ├── 软件/
│   │   ├── 办公/
│   │   └── 差旅/
│   └── Q2/
│       └── ...
```

### 按税务类别（会计师准备）
```
Invoices/
├── 可抵扣/
│   ├── 软件/
│   ├── 办公/
│   └── 专业服务/
├── 部分可抵扣/
│   └── 餐饮-差旅/
└── 个人/
```

## 自动化设置

对于持续组织：

```
创建一个脚本，用于监视我的 ~/Downloads/invoices 文件夹，并使用我们的标准命名和文件夹结构自动组织任何新的发票文件。
```

这创建了一个持久的解决方案，可以组织到达的发票。

## 高级技巧

1. **将电子邮件扫描为PDF**：使用Preview或类似软件首先将电子邮件发票保存为PDF
2. **一致的下载**：将所有发票保存到一个文件夹中以便批量处理
3. **每月例行公事**：每月而不是每年整理发票
4. **备份原始文件**：在重新组织之前保留原始文件
5. **在CSV中包含金额**：用于预算跟踪很有用
6. **按可抵扣性标记**：注意哪些费用是可抵扣的
7. **保留收据7年**：标准审计期

## 处理特殊情况

### 缺失信息
如果无法提取日期/供应商：
- 标记文件为手动审查
- 使用文件修改日期作为后备
- 创建 "需要审查/" 文件夹

### 重复发票
如果同一发票出现多次：
- 比较文件哈希
- 保留最高质量的版本
- 在摘要中注明重复项

### 多页发票
对于拆分到多个文件的发票：
- 如果需要，合并PDF
- 使用一致命名法命名部分
- 如果发票拆分，在CSV中注明

### 非标准格式
对于不寻常的收据格式：
- 提取可能的内容
- 标准化您可以的内容
- 如果关键信息缺失，则标记为审查

## 相关用例

- 创建报销费用报告
- 组织银行对账单
- 管理供应商合同
- 存档旧财务记录
- 准备审计
- 跟踪随时间变化的订阅成本